<div class="container">
  <h1 class="mb-4">Cotización</h1>
  
  <div class="d-flex justify-content-end mb-3">
    <i class="fas fa-times text-danger" style="cursor: pointer; font-size: 1.5rem;" (click)="navigateBack()"></i>
  </div>
  
  <div class="col-lg-2 col-md-4 col-sm-6 d-flex flex-wrap gap-4 mt-3 ">
    <div class="form-group w-100 selec">
      <label for="estatus" class="form-label">Estatus</label>
      <select
        id="estatus"
        class="form-select form-select-sm"
        aria-label=".form-select-sm example"
        [(ngModel)]="cotizacion.estatus"
        (change)="actualizarEstatus($event, cotizacion.id_cotizacion)">
        <option value="" selected></option>
        <option value="Pendiente">Pendiente</option>
        <option value="Aprobado">Aprobado</option>
        <option value="Denegado">Denegado</option>
      </select>
    </div>
  </div>
  
  

  <div *ngIf="loading" class="d-flex justify-content-center">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Cargando...</span>
    </div>
  </div>

  <div *ngIf="cotizacion && cotizacion.id_cotizacion">
    <div class="row">
      <div class="col-md-6">
        <div class="form-group">
          <label for="idCotizacion">Cotización:</label>
          <input id="idCotizacion" type="text" class="form-control" [value]="cotizacion.id_cotizacion" readonly>
        </div>
      </div>
      <div class="col-md-6">
        <div class="form-group">
          <label for="estatus">Estatus:</label>
          <input id="estatus" type="text" class="form-control" [(ngModel)]="cotizacion.estatus" readonly>
        </div>
      </div>
      <div class="col-md-6">
        <div class="form-group">
          <label for="nombre">Nombre:</label>
          <input id="nombre" type="text" class="form-control" [(ngModel)]="cotizacion.nombre" readonly>
        </div>
      </div>
      <div class="col-md-6">
        <div class="form-group">
          <label for="edad">Edad:</label>
          <input id="edad" type="number" class="form-control" [(ngModel)]="cotizacion.edad" readonly>
        </div>
      </div>
      <div class="col-md-6">
        <div class="form-group">
          <label for="monto">Monto:</label>
          <input id="monto" type="text" class="form-control" [(ngModel)]="cotizacion.monto" readonly>
        </div>
      </div>
      <div class="col-md-6">
        <div class="form-group">
          <label for="tipoPersona">Tipo de Persona:</label>
          <input 
            id="tipoPersona" 
            type="text" 
            class="form-control" 
            [value]="cotizacion.tipo_persona === 'f' ? 'Física' : cotizacion.tipo_persona === 'm' ? 'Moral' : ''"
            readonly
          >
        </div>
      </div>
    </div>
  </div>

  <div class="form-group mt-4">
    <label for="comentarios">Comentarios:</label>
    <textarea 
      id="comentarios" 
      class="form-control" 
      rows="4" 
      name="comentario"
    ></textarea>
  </div>
  
  <div class="text-end mt-3">
    <button class="btn btn-primary" (click)="agregarComentario()">Agregar Comentario
    </button>
  </div>


  
  

<div *ngIf="comentarios.length > 0" class="mt-4">
  <h4>Comentarios:</h4>
  <ul>
    <li *ngFor="let comentario of comentarios">
      <strong>{{ comentario.id_cotizacion }}:</strong> {{ comentario.comentarios }} <br>
      <small>{{ comentario.timestamp | date: 'dd/MM/yyyy HH:mm' }}</small>
    </li>
  </ul>
</div>
<p *ngIf="comentarios.length === 0">No hay comentarios para esta cotización.</p>
  <div *ngIf="idFinanciera" class="container mt-4">
    <app-form-docs [request]="" [isNew]=false></app-form-docs>
  </div>
</div>
